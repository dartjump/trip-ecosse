<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#0d1f17">
<title>Scotland 2026</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=SF+Pro+Display:wght@300;400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<style>
/* â”€â”€â”€ RESET & VARS â”€â”€â”€ */
*, *::before, *::after { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color:transparent; }
:root {
  --green: #1a3a2a;
  --green2: #2d6b47;
  --gold: #c9a84c;
  --cream: #f5f0e8;
  --dark: #0d1f17;
  --mist: #8aaa96;
  --card-bg: #ffffff;
  --safe-top: env(safe-area-inset-top, 44px);
  --safe-bot: env(safe-area-inset-bottom, 34px);
  --tab-h: calc(60px + var(--safe-bot));
  --header-h: calc(56px + var(--safe-top));
}

html, body {
  height: 100%;
  overflow: hidden;
  background: var(--dark);
  font-family: -apple-system, 'SF Pro Display', 'Helvetica Neue', sans-serif;
  -webkit-font-smoothing: antialiased;
}

/* â”€â”€â”€ SPLASH â”€â”€â”€ */
#splash {
  position: fixed; inset: 0; z-index: 9999;
  background: var(--dark);
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  gap: 16px;
  transition: opacity 0.5s, transform 0.5s;
}
#splash.hide { opacity: 0; pointer-events: none; transform: scale(1.05); }
.splash-flag { font-size: 80px; animation: pulse 2s infinite; }
@keyframes pulse { 0%,100%{transform:scale(1)} 50%{transform:scale(1.05)} }
.splash-title { font-family:'Playfair Display',serif; color:var(--gold); font-size:2rem; text-align:center; }
.splash-sub { color:var(--mist); font-size:0.85rem; letter-spacing:3px; text-transform:uppercase; }
.splash-bar { width:180px; height:3px; background:rgba(255,255,255,0.1); border-radius:2px; overflow:hidden; margin-top:20px; }
.splash-progress { height:100%; background:var(--gold); border-radius:2px; animation:load 1.5s ease forwards; }
@keyframes load { from{width:0} to{width:100%} }

/* â”€â”€â”€ LAYOUT â”€â”€â”€ */
#app {
  display: flex; flex-direction: column;
  height: 100vh; height: 100dvh;
  background: var(--cream);
}

/* â”€â”€â”€ TOP HEADER â”€â”€â”€ */
.top-bar {
  background: var(--dark);
  padding: var(--safe-top) 20px 0;
  height: var(--header-h);
  display: flex; align-items: flex-end; padding-bottom: 10px;
  position: relative; z-index: 100;
  box-shadow: 0 1px 0 rgba(255,255,255,0.06);
  flex-shrink: 0;
}
.top-bar-inner { display:flex; align-items:center; justify-content:space-between; width:100%; }
.app-logo { font-family:'Playfair Display',serif; color:var(--gold); font-size:1.15rem; }
.app-logo small { display:block; color:var(--mist); font-family:inherit; font-size:0.55rem; letter-spacing:3px; font-weight:400; }
.days-chip {
  background: rgba(201,168,76,0.15); border:1px solid rgba(201,168,76,0.3);
  color:var(--gold); font-size:0.7rem; padding:4px 10px; border-radius:20px;
  letter-spacing:1px;
}

/* â”€â”€â”€ CONTENT AREA â”€â”€â”€ */
#content {
  flex: 1; overflow: hidden; position: relative;
}
.tab-panel {
  display: none; position: absolute; inset: 0;
  overflow-y: auto; overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
  scroll-behavior: smooth;
}
.tab-panel.active { display: block; }

/* â”€â”€â”€ BOTTOM TAB BAR â”€â”€â”€ */
.tab-bar {
  background: rgba(13,31,23,0.95);
  backdrop-filter: blur(20px) saturate(180%);
  -webkit-backdrop-filter: blur(20px) saturate(180%);
  border-top: 1px solid rgba(255,255,255,0.08);
  padding-bottom: var(--safe-bot);
  display: flex;
  flex-shrink: 0;
  z-index: 100;
}
.tab-btn {
  flex: 1; border: none; background: none;
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  padding: 10px 4px 8px;
  cursor: pointer; transition: all 0.2s;
  color: var(--mist);
  gap: 4px;
  -webkit-tap-highlight-color: transparent;
}
.tab-btn .tab-icon { font-size: 1.4rem; transition: transform 0.2s; }
.tab-btn .tab-label { font-size: 0.62rem; font-weight: 500; letter-spacing: 0.3px; transition: all 0.2s; }
.tab-btn.active { color: var(--gold); }
.tab-btn.active .tab-icon { transform: translateY(-2px); }
.tab-btn:active .tab-icon { transform: scale(0.88); }

/* â”€â”€â”€ PLANNING â”€â”€â”€ */
#tab-planning { background: var(--dark); }

/* Hero Ã©tape */
.step-hero {
  background: linear-gradient(160deg, var(--green) 0%, #0d2a1a 100%);
  padding: 24px 20px 20px;
  position: relative; overflow: hidden;
}
.step-hero::before {
  content:''; position:absolute; top:-40px; right:-40px;
  width:200px; height:200px; border-radius:50%;
  background:rgba(201,168,76,0.06);
}
.step-hero::after {
  content:''; position:absolute; bottom:-60px; left:-20px;
  width:160px; height:160px; border-radius:50%;
  background:rgba(201,168,76,0.04);
}
.hero-day-label { color:var(--gold); font-size:0.68rem; letter-spacing:3px; text-transform:uppercase; margin-bottom:6px; font-weight:600; }
.hero-title { font-family:'Playfair Display',serif; color:#fff; font-size:2rem; line-height:1.1; margin-bottom:4px; }
.hero-from { color:var(--mist); font-size:0.82rem; margin-bottom:16px; }
.hero-stats { display:flex; gap:10px; }
.hstat {
  background: rgba(255,255,255,0.07); border:1px solid rgba(255,255,255,0.1);
  border-radius:12px; padding:10px 14px; text-align:center; flex:1;
}
.hstat-val { color:var(--gold); font-size:1.2rem; font-weight:700; font-family:'Playfair Display',serif; }
.hstat-lbl { color:var(--mist); font-size:0.6rem; text-transform:uppercase; letter-spacing:1px; }
.hero-notes { color:rgba(255,255,255,0.65); font-size:0.82rem; line-height:1.55; margin-top:14px; padding-top:14px; border-top:1px solid rgba(255,255,255,0.07); }

/* POIs */
.pois-row { display:flex; gap:6px; flex-wrap:wrap; padding:14px 20px 0; }
.poi-pill {
  background:rgba(26,58,42,0.12); border:1px solid rgba(26,58,42,0.2);
  color:var(--green); font-size:0.72rem; padding:5px 12px; border-radius:50px; font-weight:600;
}

/* Section title */
.section-heading {
  padding: 18px 20px 10px;
  color:var(--mist); font-size:0.65rem; letter-spacing:3px; text-transform:uppercase; font-weight:700;
}

/* Tiles */
.tiles-grid { display:grid; grid-template-columns:1fr 1fr; gap:10px; padding:0 16px 8px; }
.tile {
  border-radius:16px; padding:16px 14px;
  text-decoration:none; display:flex; flex-direction:column; gap:8px;
  box-shadow:0 2px 12px rgba(0,0,0,0.15);
  transition:transform 0.15s, box-shadow 0.15s;
  -webkit-tap-highlight-color:transparent;
  min-height: 90px;
}
.tile:active { transform:scale(0.96); box-shadow:0 1px 6px rgba(0,0,0,0.1); }
.tile-top { display:flex; align-items:center; gap:8px; }
.tile-emoji { font-size:1.3rem; }
.tile-name { color:#fff; font-size:0.8rem; font-weight:700; }
.tile-desc { color:rgba(255,255,255,0.65); font-size:0.68rem; line-height:1.3; }
.tile.t-hotel  { background:linear-gradient(145deg,#2d6b47,#1a3a2a); }
.tile.t-resto  { background:linear-gradient(145deg,#a04420,#6b2010); }
.tile.t-walk   { background:linear-gradient(145deg,#1e7a50,#0d4a30); }
.tile.t-castle { background:linear-gradient(145deg,#5a4520,#3a2d10); }
.tile.t-nature { background:linear-gradient(145deg,#1a557a,#0d3050); }
.tile.t-museum { background:linear-gradient(145deg,#72206a,#4a1045); }
.tile.t-transport { background:linear-gradient(145deg,#2a2a7a,#101060); }

/* Steps list */
.steps-scroll { padding:4px 0 100px; }
.step-row {
  display:flex; align-items:center; gap:14px;
  padding:14px 20px;
  border-bottom:1px solid rgba(255,255,255,0.05);
  cursor:pointer; transition:background 0.15s;
  -webkit-tap-highlight-color:transparent;
}
.step-row:active { background:rgba(201,168,76,0.08); }
.step-row.active-step { background:rgba(201,168,76,0.1); border-left:3px solid var(--gold); }
.step-dot { width:36px; height:36px; border-radius:50%; background:rgba(201,168,76,0.15); border:2px solid rgba(201,168,76,0.3); display:flex; align-items:center; justify-content:center; flex-shrink:0; }
.step-dot-day { color:var(--gold); font-size:0.75rem; font-weight:700; }
.step-row-info { flex:1; }
.step-row-to { color:#fff; font-size:0.88rem; font-weight:600; margin-bottom:2px; }
.step-row-from { color:var(--mist); font-size:0.7rem; }
.step-row-km { color:var(--gold); font-size:0.75rem; font-weight:700; text-align:right; white-space:nowrap; }
.step-row-h { color:var(--mist); font-size:0.62rem; text-align:right; }
.step-arrow { color:var(--mist); font-size:0.7rem; }

/* Switcher (hero / liste) */
.view-switcher {
  display:flex; background:rgba(255,255,255,0.06); border-radius:10px; margin:14px 20px 0; padding:3px;
}
.vsw-btn {
  flex:1; border:none; background:none; color:var(--mist); font-size:0.78rem; padding:8px; border-radius:8px; cursor:pointer; transition:all 0.2s; font-family:inherit; font-weight:600;
}
.vsw-btn.active { background:var(--gold); color:var(--dark); }

/* â”€â”€â”€ MAP â”€â”€â”€ */
#tab-map { padding:0; background:var(--dark); }
#leaflet-map { width:100%; height:100%; min-height:300px; }

/* â”€â”€â”€ METEO â”€â”€â”€ */
#tab-meteo { background:var(--cream); }
.meteo-hero {
  background: linear-gradient(160deg, var(--green), #0d2a1a);
  padding: 24px 20px 20px;
}
.meteo-hero-title { font-family:'Playfair Display',serif; color:#fff; font-size:1.6rem; margin-bottom:4px; }
.meteo-hero-sub { color:var(--mist); font-size:0.78rem; line-height:1.4; }
.meteo-live-badge {
  display:inline-flex; align-items:center; gap:5px;
  background:rgba(201,168,76,0.15); border:1px solid rgba(201,168,76,0.3);
  color:var(--gold); font-size:0.65rem; font-weight:700; letter-spacing:1px;
  padding:4px 10px; border-radius:20px; margin-bottom:12px;
}
.live-dot { width:6px; height:6px; border-radius:50%; background:#4ade80; animation:blink 1.5s infinite; }
@keyframes blink { 0%,100%{opacity:1} 50%{opacity:0.3} }

.meteo-note {
  margin:16px 16px 0;
  background:rgba(201,168,76,0.1); border:1px solid rgba(201,168,76,0.25);
  border-radius:14px; padding:12px 14px;
  font-size:0.78rem; color:var(--dark); line-height:1.5;
}
.meteo-cards { display:flex; flex-direction:column; gap:10px; padding:14px 16px 100px; }
.mc {
  background:#fff; border-radius:18px; padding:16px;
  box-shadow:0 2px 12px rgba(0,0,0,0.07);
  display:grid; grid-template-columns:1fr auto; gap:8px; align-items:center;
  text-decoration:none; color:inherit;
  transition:transform 0.15s;
}
.mc:active { transform:scale(0.98); }
.mc-left {}
.mc-city-name { font-size:1rem; font-weight:700; color:var(--dark); margin-bottom:1px; }
.mc-trip-date { font-size:0.68rem; color:var(--mist); margin-bottom:8px; letter-spacing:0.5px; }
.mc-conditions { display:flex; align-items:center; gap:8px; }
.mc-icon { font-size:1.6rem; }
.mc-desc-text { font-size:0.8rem; color:#555; }
.mc-pills { display:flex; gap:6px; margin-top:8px; flex-wrap:wrap; }
.mc-pill { background:var(--cream); color:var(--dark); font-size:0.68rem; padding:3px 8px; border-radius:20px; font-weight:600; }
.mc-temp-big { font-family:'Playfair Display',serif; font-size:2.8rem; color:var(--green); line-height:1; text-align:right; }
.mc-feel { font-size:0.7rem; color:var(--mist); text-align:right; margin-top:2px; }
.mc-skeleton { background:#f0ebe2; border-radius:18px; height:110px; animation:shimmer 1.5s infinite; }
@keyframes shimmer { 0%,100%{opacity:0.5} 50%{opacity:1} }

/* Conseils */
.tips-section { padding:0 16px 20px; }
.tips-title { font-family:'Playfair Display',serif; color:var(--green); font-size:1.2rem; margin:20px 0 12px; }
.tip-card { background:#fff; border-radius:14px; padding:14px 16px; margin-bottom:8px; display:flex; gap:12px; align-items:flex-start; box-shadow:0 1px 6px rgba(0,0,0,0.06); }
.tip-emoji { font-size:1.4rem; flex-shrink:0; margin-top:1px; }
.tip-text strong { display:block; font-size:0.82rem; color:var(--dark); margin-bottom:3px; }
.tip-text span { font-size:0.75rem; color:#666; line-height:1.4; }

/* â”€â”€â”€ CALENDRIER â”€â”€â”€ */
#tab-cal { background:var(--cream); }
.cal-header-block {
  background:linear-gradient(160deg,var(--green),#0d2a1a);
  padding:24px 20px 20px;
}
.cal-header-title { font-family:'Playfair Display',serif; color:#fff; font-size:1.6rem; margin-bottom:4px; }
.cal-header-sub { color:var(--mist); font-size:0.78rem; }
.cal-stats { display:flex; gap:8px; margin-top:14px; overflow-x:auto; padding-bottom:2px; }
.cal-stat {
  background:rgba(255,255,255,0.08); border:1px solid rgba(255,255,255,0.1);
  border-radius:12px; padding:10px 14px; text-align:center; flex-shrink:0;
}
.cal-stat-val { color:var(--gold); font-family:'Playfair Display',serif; font-size:1.3rem; }
.cal-stat-lbl { color:var(--mist); font-size:0.58rem; letter-spacing:1px; text-transform:uppercase; }

.cal-body { padding:16px 16px 100px; }
.cal-month-block { margin-bottom:24px; }
.cal-month-name { font-size:0.78rem; font-weight:700; color:var(--mist); letter-spacing:2px; text-transform:uppercase; margin-bottom:10px; }
.cal-grid { display:grid; grid-template-columns:repeat(7,1fr); gap:3px; }
.cal-day-hdr { text-align:center; font-size:0.6rem; font-weight:700; color:var(--mist); letter-spacing:1px; padding:4px 0; }
.cal-cell {
  background:#fff; border-radius:10px; min-height:54px;
  padding:5px 4px; position:relative;
}
.cal-cell.empty { background:rgba(0,0,0,0.03); }
.cal-cell.trip { background:#e8f4ec; cursor:pointer; }
.cal-cell.trip:active { background:#cde3d4; transform:scale(0.96); }
.cal-num { font-size:0.75rem; font-weight:700; color:#ccc; }
.cal-cell.trip .cal-num { color:var(--green); }
.cal-tag {
  margin-top:3px; font-size:0.5rem; font-weight:700;
  padding:2px 4px; border-radius:5px; line-height:1.3; display:block;
  background:var(--green); color:#fff;
}
.cal-tag.gold { background:var(--gold); color:var(--dark); }

/* â”€â”€â”€ GLOBAL â”€â”€â”€ */
.pb-safe { padding-bottom:calc(80px + var(--safe-bot)); }
</style>
</head>
<body>

<!-- SPLASH -->
<div id="splash">
  <div class="splash-flag">ğŸ´ó §ó ¢ó ³ó £ó ´ó ¿</div>
  <div class="splash-title">Scotland Roadtrip</div>
  <div class="splash-sub">Mars 2026</div>
  <div class="splash-bar"><div class="splash-progress"></div></div>
</div>

<!-- APP -->
<div id="app">

  <!-- TOP BAR -->
  <div class="top-bar">
    <div class="top-bar-inner">
      <div class="app-logo">Scotland 2026 <small>ROADTRIP Â· MARS</small></div>
      <div class="days-chip">11 jours</div>
    </div>
  </div>

  <!-- CONTENT -->
  <div id="content">

    <!-- â•â•â• PLANNING â•â•â• -->
    <div id="tab-planning" class="tab-panel active">
      <div class="view-switcher">
        <button class="vsw-btn active" onclick="setPlanView('detail')">ğŸ“ Ã‰tape</button>
        <button class="vsw-btn" onclick="setPlanView('list')">ğŸ“‹ Liste</button>
      </div>

      <!-- Detail view -->
      <div id="plan-detail">
        <div id="step-hero-content"></div>
        <div id="step-tiles-content"></div>
      </div>

      <!-- List view -->
      <div id="plan-list" style="display:none;">
        <div class="steps-scroll" id="steps-list-el"></div>
      </div>
    </div>

    <!-- â•â•â• MAP â•â•â• -->
    <div id="tab-map" class="tab-panel">
      <div id="leaflet-map"></div>
    </div>

    <!-- â•â•â• METEO â•â•â• -->
    <div id="tab-meteo" class="tab-panel">
      <div class="meteo-hero">
        <div class="meteo-live-badge"><div class="live-dot"></div> EN DIRECT</div>
        <div class="meteo-hero-title">â˜ï¸ MÃ©tÃ©o</div>
        <div class="meteo-hero-sub">Conditions actuelles pour chaque Ã©tape de ton voyage</div>
      </div>
      <div class="meteo-note">
        â„¹ï¸ Les donnÃ©es sont <strong>en temps rÃ©el</strong> via Open-Meteo. Reviens Ã  l'approche du voyage pour voir les vraies prÃ©visions de mars 2026 !
      </div>
      <div class="meteo-cards" id="meteo-cards"></div>
      <div class="tips-section">
        <div class="tips-title">ğŸ’ Conseils pour Mars</div>
        <div class="tip-card"><div class="tip-emoji">ğŸ§¥</div><div class="tip-text"><strong>Layering essentiel</strong><span>Le temps change vite. Habille-toi en couches â€” impermÃ©able toujours accessible.</span></div></div>
        <div class="tip-card"><div class="tip-emoji">ğŸ’¨</div><div class="tip-text"><strong>Vent dans les Highlands</strong><span>CrÃªtes et cÃ´tes trÃ¨s venteuses. PrÃ©vois coupe-vent impermÃ©able.</span></div></div>
        <div class="tip-card"><div class="tip-emoji">ğŸŒ…</div><div class="tip-text"><strong>Belles lumiÃ¨res de mars</strong><span>Lever ~6h30, coucher ~18h30. LumiÃ¨re dorÃ©e parfaite pour les photos !</span></div></div>
        <div class="tip-card"><div class="tip-emoji">ğŸŒŠ</div><div class="tip-text"><strong>Ferries variables</strong><span>Le ferry Mallaig â†’ Armadale peut Ãªtre annulÃ©. Alternative : Pont de Skye (gratuit).</span></div></div>
        <div class="tip-card"><div class="tip-emoji">â„ï¸</div><div class="tip-text"><strong>Routes en altitude</strong><span>Quelques cols peuvent Ãªtre enneigÃ©s. VÃ©rifie via Traffic Scotland.</span></div></div>
      </div>
    </div>

    <!-- â•â•â• CALENDRIER â•â•â• -->
    <div id="tab-cal" class="tab-panel">
      <div class="cal-header-block">
        <div class="cal-header-title">ğŸ“… Calendrier</div>
        <div class="cal-header-sub">Vue d'ensemble du voyage</div>
        <div class="cal-stats">
          <div class="cal-stat"><div class="cal-stat-val">3183</div><div class="cal-stat-lbl">km total</div></div>
          <div class="cal-stat"><div class="cal-stat-val">11</div><div class="cal-stat-lbl">jours</div></div>
          <div class="cal-stat"><div class="cal-stat-val">41h</div><div class="cal-stat-lbl">conduite</div></div>
          <div class="cal-stat"><div class="cal-stat-val">8</div><div class="cal-stat-lbl">hÃ´tels</div></div>
          <div class="cal-stat"><div class="cal-stat-val">2</div><div class="cal-stat-lbl">ferries</div></div>
        </div>
      </div>
      <div class="cal-body">
        <div class="cal-month-block">
          <div class="cal-month-name">FÃ©vrier 2026</div>
          <div class="cal-grid" id="cal-feb"></div>
        </div>
        <div class="cal-month-block">
          <div class="cal-month-name">Mars 2026</div>
          <div class="cal-grid" id="cal-mar"></div>
        </div>
      </div>
    </div>

  </div><!-- /content -->

  <!-- BOTTOM TAB BAR -->
  <div class="tab-bar">
    <button class="tab-btn active" onclick="switchTab('planning',this)">
      <div class="tab-icon">ğŸ—ºï¸</div>
      <div class="tab-label">Planning</div>
    </button>
    <button class="tab-btn" onclick="switchTab('map',this)">
      <div class="tab-icon">ğŸ“</div>
      <div class="tab-label">Carte</div>
    </button>
    <button class="tab-btn" onclick="switchTab('meteo',this)">
      <div class="tab-icon">â˜ï¸</div>
      <div class="tab-label">MÃ©tÃ©o</div>
    </button>
    <button class="tab-btn" onclick="switchTab('cal',this)">
      <div class="tab-icon">ğŸ“…</div>
      <div class="tab-label">Calendrier</div>
    </button>
  </div>

</div><!-- /app -->

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DATA
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const steps = [
  {
    dayLabel:"Jeu 26 FÃ©v", dayShort:"26/2", from:"Genval", to:"Calais",
    km:226, h:2.5, hotel:null, hotelUrl:null,
    lat:50.9548, lng:1.8587,
    pois:["Route vers la mer","Embarquement Tunnel"],
    notes:"DÃ©part de Genval vers Calais. Embarquement Eurotunnel en soirÃ©e vers Folkestone.",
    tiles:{ hotel:null, resto:"https://www.tripadvisor.fr/Restaurants-g187064-Calais.html", walk:null, castle:null, nature:null, museum:null, transport:"https://www.eurotunnel.com/fr/" }
  },
  {
    dayLabel:"Jeu 26 â€“ Nuit", dayShort:"26/2", from:"Folkestone", to:"Carlisle",
    km:600, h:6, hotel:"Crown & Mitre", hotelUrl:"https://www.booking.com/hotel/gb/crown-and-mitre.fr.html",
    lat:54.8951, lng:-2.9382,
    pois:["ArrivÃ©e ~21h","Carlisle"],
    notes:"TraversÃ©e de l'Angleterre de nuit. ArrivÃ©e Ã  Carlisle vers 21h. Repos au Crown & Mitre.",
    tiles:{ hotel:"https://www.booking.com/hotel/gb/crown-and-mitre.fr.html", resto:"https://www.tripadvisor.fr/Restaurants-g186385-Carlisle.html", walk:null, castle:"https://www.carlislecastle.org.uk/", nature:null, museum:null, transport:"https://www.eurotunnel.com/fr/" }
  },
  {
    dayLabel:"Ven 27 FÃ©v", dayShort:"27/2", from:"Carlisle", to:"Fort William",
    km:320, h:4, hotel:"Loch Leven Hotel", hotelUrl:"https://www.lochleven-hotel.co.uk/",
    lat:56.8198, lng:-5.1052,
    pois:["Mur d'Hadrien","Glencoe"],
    notes:"EntrÃ©e en Ã‰cosse ! ArrÃªt au Mur d'Hadrien puis route vers les Highlands via Glencoe.",
    tiles:{ hotel:"https://www.lochleven-hotel.co.uk/", resto:"https://www.tripadvisor.fr/Restaurants-g551782-Fort_William.html", walk:"https://www.walkhighlands.co.uk/lochaber/glencoe.shtml", castle:"https://www.english-heritage.org.uk/visit/places/housesteads-roman-fort-hadrians-wall/", nature:"https://www.glencoe-visitor-centre.org.uk/", museum:"https://www.visitscotland.com/info/see-do/glencoe-visitor-centre-p247821", transport:"https://www.google.com/maps/dir/Carlisle/Fort+William" }
  },
  {
    dayLabel:"Sam 28 FÃ©v", dayShort:"28/2", from:"Fort William", to:"Skye Â· Linicro",
    km:170, h:3, hotel:"Monkstadt House", hotelUrl:"https://www.monkstadt.co.uk/",
    lat:57.5822, lng:-6.2122,
    pois:["Ferry Mallaig â†’ Armadale","Cuillins","Viaduc Glenfinnan"],
    notes:"Route vers Mallaig via le spectaculaire Viaduc de Glenfinnan â€” puis ferry vers Skye !",
    tiles:{ hotel:"https://www.monkstadt.co.uk/", resto:"https://www.tripadvisor.fr/Restaurants-g580218-Isle_of_Skye.html", walk:"https://www.walkhighlands.co.uk/skye/", castle:null, nature:"https://www.visitscotland.com/destinations-maps/isle-of-skye/", museum:null, transport:"https://www.calmac.co.uk/route/mallaig-armadale" }
  },
  {
    dayLabel:"Dim 1 Mar", dayShort:"1/3", from:"Linicro", to:"Skye Â· Trotternish",
    km:0, h:0, hotel:"Monkstadt House", hotelUrl:"https://www.monkstadt.co.uk/",
    lat:57.5822, lng:-6.2122,
    pois:["Old Man of Storr","Kilt Rock","Quiraing","Duntulm Castle"],
    notes:"JournÃ©e exploration de la pÃ©ninsule Trotternish. Paysages volcaniques spectaculaires !",
    tiles:{ hotel:"https://www.monkstadt.co.uk/", resto:"https://www.tripadvisor.fr/Restaurants-g580218-Isle_of_Skye.html", walk:"https://www.walkhighlands.co.uk/skye/storr.shtml", castle:"https://www.duntulm.co.uk/", nature:"https://www.walkhighlands.co.uk/skye/quiraing.shtml", museum:"https://www.skye-museum.co.uk/", transport:null }
  },
  {
    dayLabel:"Lun 2 Mar", dayShort:"2/3", from:"Linicro", to:"Ullapool",
    km:330, h:6.5, hotel:"Kylesku Hotel", hotelUrl:"https://www.kyleskuhotel.co.uk/",
    lat:57.8960, lng:-5.1589,
    pois:["Eilean Donan Castle","North Coast Tour"],
    notes:"Longue route cÃ´tiÃ¨re magnifique. ArrÃªt incontournable Ã  Eilean Donan Castle !",
    tiles:{ hotel:"https://www.kyleskuhotel.co.uk/", resto:"https://www.tripadvisor.fr/Restaurants-g551793-Ullapool.html", walk:"https://www.visitscotland.com/destinations-maps/northern-highlands/", castle:"https://www.eileandonancastle.com/", nature:"https://www.visitscotland.com/info/see-do/inverpolly-national-nature-reserve-p245201", museum:null, transport:null }
  },
  {
    dayLabel:"Mar 3 Mar", dayShort:"3/3", from:"Ullapool", to:"Tongue",
    km:111, h:2.5, hotel:"Tongue Hotel", hotelUrl:"https://www.tonguehotel.co.uk/",
    lat:58.4807, lng:-4.4204,
    pois:["Sandwood Beach","CÃ´te Nord-Ouest"],
    notes:"Route vers le nord. Sandwood Beach est l'une des plus belles plages sauvages d'Ã‰cosse.",
    tiles:{ hotel:"https://www.tonguehotel.co.uk/", resto:"https://www.tripadvisor.fr/Restaurants-g551805-Tongue.html", walk:"https://www.walkhighlands.co.uk/sutherland/sandwood-bay.shtml", castle:null, nature:"https://www.walkhighlands.co.uk/sutherland/sandwood-bay.shtml", museum:null, transport:null }
  },
  {
    dayLabel:"Mer 4 Mar", dayShort:"4/3", from:"Tongue", to:"Tongue Â· Explorations",
    km:0, h:0, hotel:"Tongue Hotel", hotelUrl:"https://www.tonguehotel.co.uk/",
    lat:58.4807, lng:-4.4204,
    pois:["Smoo Cave","Kyle of Tongue","Cape Wrath"],
    notes:"JournÃ©e locale. La Smoo Cave est impressionnante et la vue sur Kyle of Tongue est magique.",
    tiles:{ hotel:"https://www.tonguehotel.co.uk/", resto:"https://www.tripadvisor.fr/Restaurants-g551805-Tongue.html", walk:"https://www.walkhighlands.co.uk/sutherland/smoo-cave.shtml", castle:null, nature:"https://www.visitscotland.com/info/see-do/smoo-cave-p247751", museum:null, transport:null }
  },
  {
    dayLabel:"Jeu 5 Mar", dayShort:"5/3", from:"Tongue", to:"Inverness",
    km:190, h:3, hotel:"Lochardil House", hotelUrl:"https://www.lochardilhouse.co.uk/",
    lat:57.4778, lng:-4.2247,
    pois:["Dunrobin Castle","Dornoch Cathedral"],
    notes:"Retour vers le sud via la cÃ´te est. ArrÃªt Ã  Dunrobin Castle, le plus grand chÃ¢teau des Highlands.",
    tiles:{ hotel:"https://www.lochardilhouse.co.uk/", resto:"https://www.tripadvisor.fr/Restaurants-g186543-Inverness.html", walk:"https://www.walkhighlands.co.uk/inverness/", castle:"https://www.dunrobincastle.co.uk/", nature:null, museum:"https://www.inverness-museum.com/", transport:null }
  },
  {
    dayLabel:"Ven 6 Mar", dayShort:"6/3", from:"Inverness", to:"Edinburgh",
    km:250, h:3, hotel:"Ibis Edinburgh", hotelUrl:"https://all.accor.com/hotel/6444/index.fr.shtml",
    lat:55.9533, lng:-3.1883,
    pois:["Royal Mile","Edinburgh Castle","Whisky Bar","Holyrood"],
    notes:"ArrivÃ©e Ã  Edinburgh ! SoirÃ©e sur le Royal Mile, whisky bar, l'atmosphÃ¨re est unique.",
    tiles:{ hotel:"https://all.accor.com/hotel/6444/index.fr.shtml", resto:"https://www.tripadvisor.fr/Restaurants-g186525-Edinburgh.html", walk:"https://www.walkhighlands.co.uk/lothian/", castle:"https://www.edinburghcastle.scot/", nature:"https://www.holyrood.info/", museum:"https://www.nms.ac.uk/national-museum-of-scotland/", transport:null }
  },
  {
    dayLabel:"Sam 7 Mar", dayShort:"7/3", from:"Edinburgh", to:"Cambridge",
    km:570, h:6, hotel:"Ã€ confirmer", hotelUrl:"https://www.booking.com/city/gb/cambridge.fr.html",
    lat:52.2053, lng:0.1218,
    pois:["Route retour","Cambridge"],
    notes:"Grande route de retour vers le sud via l'Angleterre.",
    tiles:{ hotel:"https://www.booking.com/city/gb/cambridge.fr.html", resto:"https://www.tripadvisor.fr/Restaurants-g186225-Cambridge.html", walk:"https://www.visitcambridge.org/", castle:null, nature:null, museum:"https://www.fitzmuseum.cam.ac.uk/", transport:null }
  },
  {
    dayLabel:"Dim 8 Mar", dayShort:"8/3", from:"Cambridge", to:"Genval ğŸ¡",
    km:416, h:4.5, hotel:"Maison", hotelUrl:null,
    lat:50.6292, lng:4.5833,
    pois:["Folkestone â†’ Calais","Eurotunnel","Retour Genval"],
    notes:"Retour en Belgique via l'Eurotunnel. Fin d'un beau voyage !",
    tiles:{ hotel:null, resto:null, walk:null, castle:null, nature:null, museum:null, transport:"https://www.eurotunnel.com/fr/" }
  }
];

const TILE_CONFIG = {
  hotel:     { emoji:'ğŸ¨', name:'HÃ©bergement', cls:'t-hotel' },
  resto:     { emoji:'ğŸ½ï¸', name:'Restaurants', cls:'t-resto' },
  walk:      { emoji:'ğŸ¥¾', name:'Balades', cls:'t-walk' },
  castle:    { emoji:'ğŸ°', name:'ChÃ¢teaux', cls:'t-castle' },
  nature:    { emoji:'ğŸŒŠ', name:'Nature & Plages', cls:'t-nature' },
  museum:    { emoji:'ğŸ›ï¸', name:'MusÃ©es', cls:'t-museum' },
  transport: { emoji:'ğŸš¢', name:'Transports', cls:'t-transport' }
};

// â”€â”€ STATE â”€â”€
let currentStep = 0;
let planView = 'detail';
let mapReady = false;
let mapInstance = null;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PLANNING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderStepHero(i) {
  const s = steps[i];
  document.getElementById('step-hero-content').innerHTML = `
    <div class="step-hero">
      <div class="hero-day-label">${s.dayLabel}</div>
      <div class="hero-title">${s.to}</div>
      <div class="hero-from">Depuis ${s.from}</div>
      ${s.km > 0 ? `
      <div class="hero-stats">
        <div class="hstat"><div class="hstat-val">${s.km}</div><div class="hstat-lbl">km</div></div>
        <div class="hstat"><div class="hstat-val">${s.h}h</div><div class="hstat-lbl">route</div></div>
        ${s.hotel ? `<div class="hstat"><div class="hstat-val">ğŸ¨</div><div class="hstat-lbl">${s.hotel.split(' ')[0]}</div></div>` : ''}
      </div>` : `
      <div class="hero-stats">
        <div class="hstat"><div class="hstat-val">ğŸ </div><div class="hstat-lbl">Ã‰tape repos</div></div>
        ${s.hotel ? `<div class="hstat"><div class="hstat-val">ğŸ¨</div><div class="hstat-lbl">${s.hotel.split(' ')[0]}</div></div>` : ''}
      </div>`}
      <div class="hero-notes">${s.notes}</div>
    </div>
    ${s.pois.length ? `
    <div class="pois-row">
      ${s.pois.map(p=>`<div class="poi-pill">ğŸ“ ${p}</div>`).join('')}
    </div>` : ''}
    <div class="section-heading">Ressources</div>
  `;

  const tiles = Object.entries(s.tiles)
    .filter(([,url]) => url)
    .map(([type, url]) => {
      const c = TILE_CONFIG[type];
      return `
        <a href="${url}" target="_blank" class="tile ${c.cls}">
          <div class="tile-top"><div class="tile-emoji">${c.emoji}</div><div class="tile-name">${c.name}</div></div>
          <div class="tile-desc">${getTileDesc(type, s)}</div>
        </a>`;
    }).join('');
  document.getElementById('step-tiles-content').innerHTML = `<div class="tiles-grid">${tiles}</div><div style="height:80px"></div>`;
}

function getTileDesc(type, s) {
  const d = {
    hotel: s.hotel || 'Voir les hÃ©bergements disponibles',
    resto: 'Restaurants & pubs locaux',
    walk: 'Sentiers et randonnÃ©es de la rÃ©gion',
    castle: 'ChÃ¢teaux & monuments historiques',
    nature: 'Plages, cascades, parcs naturels',
    museum: 'MusÃ©es & expositions',
    transport: 'Ferries, Eurotunnel & transports'
  };
  return d[type];
}

function renderStepsList() {
  document.getElementById('steps-list-el').innerHTML = steps.map((s,i) => `
    <div class="step-row ${i===currentStep?'active-step':''}" onclick="selectStep(${i})">
      <div class="step-dot"><div class="step-dot-day">${s.dayShort}</div></div>
      <div class="step-row-info">
        <div class="step-row-to">${s.to}</div>
        <div class="step-row-from">Depuis ${s.from}</div>
      </div>
      <div>
        <div class="step-row-km">${s.km > 0 ? s.km+' km' : 'ğŸ '}</div>
        <div class="step-row-h">${s.h > 0 ? s.h+'h route' : 'JournÃ©e'}</div>
      </div>
      <div class="step-arrow">â€º</div>
    </div>
  `).join('');
}

function selectStep(i) {
  currentStep = i;
  renderStepHero(i);
  renderStepsList();
  setPlanView('detail');
  document.getElementById('plan-detail').scrollTop = 0;
  document.getElementById('tab-planning').scrollTop = 0;
  if (mapInstance) mapInstance.setView([steps[i].lat, steps[i].lng], 9);
}

function setPlanView(v) {
  planView = v;
  document.getElementById('plan-detail').style.display = v==='detail' ? 'block' : 'none';
  document.getElementById('plan-list').style.display   = v==='list'   ? 'block' : 'none';
  document.querySelectorAll('.vsw-btn').forEach((b,i) => {
    b.classList.toggle('active', (i===0 && v==='detail') || (i===1 && v==='list'));
  });
  if (v==='list') renderStepsList();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MAP
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function initMap() {
  if (mapReady) { setTimeout(()=>mapInstance.invalidateSize(true),150); return; }
  mapReady = true;
  const el = document.getElementById('leaflet-map');
  el.style.height = (window.innerHeight - 56 - 60) + 'px';

  mapInstance = L.map('leaflet-map', { zoomControl:false }).setView([57.2, -4.8], 6);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
    attribution:'Â© OpenStreetMap', maxZoom:18
  }).addTo(mapInstance);

  L.control.zoom({ position:'bottomright' }).addTo(mapInstance);

  const coords = steps.map(s=>[s.lat,s.lng]);
  L.polyline(coords,{color:'#c9a84c',weight:3,opacity:0.85,dashArray:'8,6'}).addTo(mapInstance);

  steps.forEach((s,i) => {
    const isEndpoint = i===0||i===steps.length-1;
    const m = L.circleMarker([s.lat,s.lng],{
      radius: isEndpoint ? 9 : 7,
      fillColor: isEndpoint ? '#c9a84c' : '#2d6b47',
      color:'#fff', weight:2, fillOpacity:1
    }).addTo(mapInstance);
    m.bindPopup(`
      <div style="font-family:-apple-system,sans-serif;min-width:160px">
        <strong style="color:#1a3a2a;font-size:0.95rem">${s.to}</strong><br>
        <span style="color:#8aaa96;font-size:0.72rem">${s.dayLabel}</span>
        ${s.hotel?`<br><span style="color:#c9a84c;font-size:0.75rem">ğŸ¨ ${s.hotel}</span>`:''}
        ${s.km>0?`<br><span style="font-size:0.75rem">${s.km} km Â· ${s.h}h</span>`:''}
        <br><div style="margin-top:6px;display:flex;flex-wrap:wrap;gap:4px">
          ${s.pois.map(p=>`<span style="background:#e8f4ec;color:#1a3a2a;padding:2px 6px;border-radius:8px;font-size:0.65rem;font-weight:600">${p}</span>`).join('')}
        </div>
      </div>
    `,{maxWidth:220});
    m.on('click',()=>{ selectStep(i); switchTabById('planning'); });
  });

  setTimeout(()=>mapInstance.invalidateSize(true),300);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MÃ‰TÃ‰O
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const weatherLocs = [
  {city:"Carlisle",      day:"Jeu 26 FÃ©v", lat:54.8951, lng:-2.9382},
  {city:"Fort William",  day:"Ven 27 FÃ©v", lat:56.8198, lng:-5.1052},
  {city:"Isle of Skye",  day:"Samâ€“Dim",    lat:57.5822, lng:-6.2122},
  {city:"Ullapool",      day:"Lun 2 Mar",  lat:57.896,  lng:-5.1589},
  {city:"Tongue",        day:"Marâ€“Mer",    lat:58.4807, lng:-4.4204},
  {city:"Inverness",     day:"Jeu 5 Mar",  lat:57.4778, lng:-4.2247},
  {city:"Edinburgh",     day:"Ven 6 Mar",  lat:55.9533, lng:-3.1883},
  {city:"Cambridge",     day:"Sam 7 Mar",  lat:52.2053, lng:0.1218}
];
const WMO={0:["â˜€ï¸","Ciel dÃ©gagÃ©"],1:["ğŸŒ¤ï¸","Peu nuageux"],2:["â›…","Nuageux"],3:["â˜ï¸","Couvert"],45:["ğŸŒ«ï¸","Brouillard"],48:["ğŸŒ«ï¸","Brouillard givrant"],51:["ğŸŒ¦ï¸","Bruine lÃ©gÃ¨re"],53:["ğŸŒ¦ï¸","Bruine"],55:["ğŸŒ§ï¸","Bruine dense"],61:["ğŸŒ§ï¸","Pluie lÃ©gÃ¨re"],63:["ğŸŒ§ï¸","Pluie modÃ©rÃ©e"],65:["ğŸŒ§ï¸","Pluie forte"],71:["ğŸŒ¨ï¸","Neige lÃ©gÃ¨re"],73:["ğŸŒ¨ï¸","Neige"],75:["â„ï¸","Neige forte"],80:["ğŸŒ¦ï¸","Averses"],81:["ğŸŒ§ï¸","Averses mod."],82:["â›ˆï¸","Averses fortes"],85:["ğŸŒ¨ï¸","Neige averses"],86:["â„ï¸","Neige forte"],95:["â›ˆï¸","Orage"],96:["â›ˆï¸","Orage & grÃªle"],99:["â›ˆï¸","Orage fort"]};

async function loadMeteo() {
  const el = document.getElementById('meteo-cards');
  el.innerHTML = weatherLocs.map(l=>`<div class="mc-skeleton" style="height:110px;border-radius:18px;"></div>`).join('');
  const results = await Promise.allSettled(weatherLocs.map(async l=>{
    const r = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${l.lat}&longitude=${l.lng}&current=temperature_2m,apparent_temperature,relative_humidity_2m,wind_speed_10m,weather_code&wind_speed_unit=kmh&timezone=Europe%2FLondon`);
    const d = await r.json();
    const c = d.current;
    const [icon,desc] = WMO[c.weather_code]||["ğŸŒ¡ï¸","N/A"];
    return {...l, icon, desc, temp:Math.round(c.temperature_2m), feel:Math.round(c.apparent_temperature), wind:Math.round(c.wind_speed_10m), hum:Math.round(c.relative_humidity_2m)};
  }));
  el.innerHTML = results.map((r,i)=>{
    const l = weatherLocs[i];
    if(r.status==='rejected') return `<div class="mc"><div class="mc-left"><div class="mc-city-name">${l.city}</div><div class="mc-trip-date">${l.day}</div><div style="color:#aaa;font-size:0.8rem">âŒ DonnÃ©es indisponibles</div></div></div>`;
    const w = r.value;
    return `
      <div class="mc">
        <div class="mc-left">
          <div class="mc-city-name">${w.city}</div>
          <div class="mc-trip-date">${w.day}</div>
          <div class="mc-conditions">
            <div class="mc-icon">${w.icon}</div>
            <div class="mc-desc-text">${w.desc}</div>
          </div>
          <div class="mc-pills">
            <div class="mc-pill">ğŸ’¨ ${w.wind} km/h</div>
            <div class="mc-pill">ğŸ’§ ${w.hum}%</div>
          </div>
        </div>
        <div>
          <div class="mc-temp-big">${w.temp}Â°</div>
          <div class="mc-feel">Ressenti ${w.feel}Â°</div>
        </div>
      </div>`;
  }).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CALENDRIER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const TRIP = {
  "2026-02-26":{label:"DÃ©part",cls:"gold"},
  "2026-02-27":{label:"â†’ Carlisle"},
  "2026-02-28":{label:"â†’ Ft William"},
  "2026-03-01":{label:"â†’ Skye"},
  "2026-03-02":{label:"Skye tour"},
  "2026-03-03":{label:"â†’ Ullapool"},
  "2026-03-04":{label:"â†’ Tongue"},
  "2026-03-05":{label:"Smoo Cave"},
  "2026-03-06":{label:"â†’ Inverness"},
  "2026-03-07":{label:"â†’ Edinburgh"},
  "2026-03-08":{label:"â†’ Cambridge"},
  "2026-03-09":{label:"Retour ğŸ¡",cls:"gold"}
};
const DAY_IDX = {"2026-02-26":0,"2026-02-27":1,"2026-02-28":2,"2026-03-01":3,"2026-03-02":4,"2026-03-03":5,"2026-03-04":6,"2026-03-05":7,"2026-03-06":8,"2026-03-07":9,"2026-03-08":10,"2026-03-09":11};

function buildCal(id, y, m) {
  const days=['L','M','M','J','V','S','D'];
  let h = days.map(d=>`<div class="cal-day-hdr">${d}</div>`).join('');
  let dow = new Date(y,m-1,1).getDay(); dow = dow===0?6:dow-1;
  for(let e=0;e<dow;e++) h+=`<div class="cal-cell empty"></div>`;
  const tot = new Date(y,m,0).getDate();
  for(let d=1;d<=tot;d++){
    const k=`${y}-${String(m).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
    const t=TRIP[k];
    h+=`<div class="cal-cell ${t?'trip':''}" ${t?`onclick="calClick('${k}')"`:''}><div class="cal-num">${d}</div>${t?`<span class="cal-tag ${t.cls||''}">${t.label}</span>`:''}</div>`;
  }
  document.getElementById(id).innerHTML=h;
}

function calClick(k){
  const i=DAY_IDX[k];
  if(i!==undefined){ selectStep(i); switchTabById('planning'); }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function switchTab(id, btn) {
  document.querySelectorAll('.tab-panel').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
  document.getElementById('tab-'+id).classList.add('active');
  btn.classList.add('active');
  if(id==='map') setTimeout(initMap, 50);
}
function switchTabById(id) {
  const idx = ['planning','map','meteo','cal'].indexOf(id);
  if(idx>=0) switchTab(id, document.querySelectorAll('.tab-btn')[idx]);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
window.addEventListener('DOMContentLoaded', ()=>{
  // Splash hide after load animation
  setTimeout(()=>{ document.getElementById('splash').classList.add('hide'); }, 1600);

  // Init
  renderStepHero(0);
  buildCal('cal-feb',2026,2);
  buildCal('cal-mar',2026,3);
  loadMeteo();
});
</script>
</body>
</html>
